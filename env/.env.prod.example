# Production profile.
# Copy to env/.env.prod (or inject via secret manager in production).
# Passwords/keys belong in env/.env.secrets (not here).
# Optional service overrides:
# - env/.env.prod.api
# - env/.env.prod.mcp
# - env/.env.prod.worker_cpu
# - env/.env.prod.worker_io
# - env/.env.prod.beat

# ── App Runtime ──────────────────────────────────
APP_ENV=prod
DEBUG=false
LOG_LEVEL=INFO
HOST=0.0.0.0
PORT=8000
API_PUBLIC_BASE_URL=https://api.minsyai.com

# ── MCP URLs ─────────────────────────────────────
MCP_SERVER_URL_STRATEGY_PROD=https://mcp.minsyai.com/strategy/mcp
MCP_SERVER_URL_BACKTEST_PROD=https://mcp.minsyai.com/backtest/mcp
MCP_SERVER_URL_MARKET_DATA_PROD=https://mcp.minsyai.com/market/mcp
MCP_SERVER_URL_STRESS_PROD=https://mcp.minsyai.com/stress/mcp
MCP_SERVER_URL_TRADING_PROD=https://mcp.minsyai.com/trading/mcp
MCP_SERVER_URL_STRATEGY_DEV=https://dev.minsyai.com/strategy/mcp
MCP_SERVER_URL_BACKTEST_DEV=https://dev.minsyai.com/backtest/mcp
MCP_SERVER_URL_MARKET_DATA_DEV=https://dev.minsyai.com/market/mcp
MCP_SERVER_URL_STRESS_DEV=https://dev.minsyai.com/stress/mcp
MCP_SERVER_URL_TRADING_DEV=https://dev.minsyai.com/trading/mcp

# ── Database ─────────────────────────────────────
# Password in env/.env.secrets
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_DB=minsy_pgsql

# ── Redis ────────────────────────────────────────
# Password in env/.env.secrets
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0

# ── Celery ───────────────────────────────────────
# db1 for broker, db2 for results; leave empty to fallback to REDIS_DB.
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2
CELERY_TASK_DEFAULT_QUEUE=backtest
CELERY_WORKER_MAX_MEMORY_PER_CHILD=524288
CELERY_WORKER_PREFETCH_MULTIPLIER=1

# ── Paper Trading & Market Data ──────────────────
# Keep runtime defaults explicit.
PAPER_TRADING_ENABLED=true
PAPER_TRADING_ENQUEUE_ON_START=true
PAPER_TRADING_EXECUTE_ORDERS=true
PAPER_TRADING_RUNTIME_TASK_EXPIRES_SECONDS=120
PAPER_TRADING_QUEUE_BACKLOG_SOFT_LIMIT=2000
PAPER_TRADING_SCHEDULER_MAX_ENQUEUES_PER_TICK=500

# Redis switches follow APP_ENV=prod defaults when blank.
MARKET_DATA_MEMORY_CACHE_ENABLED=true
MARKET_DATA_REDIS_WRITE_ENABLED=
MARKET_DATA_REDIS_READ_ENABLED=
MARKET_DATA_REDIS_SUBS_ENABLED=
MARKET_DATA_RUNTIME_FAIL_FAST_ON_REDIS_ERROR=

# ── Flower (Celery monitoring) ───────────────────
# Password in env/.env.secrets
FLOWER_ENABLED=true
FLOWER_HOST=0.0.0.0
FLOWER_PORT=5555
FLOWER_USER=admin

# ── CORS ─────────────────────────────────────────
CORS_ORIGINS=["https://app.minsyai.com","https://dev.minsyai.com"]
CORS_ORIGIN_REGEX=

# ── Observability ────────────────────────────────
# SENTRY_DSN in env/.env.secrets
SENTRY_ENV=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1
