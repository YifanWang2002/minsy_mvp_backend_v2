# Main -> 重构后测试迁移矩阵

| 旧测试文件 | 目标新目录 | 当前状态 |
|---|---|---|
| `test_agents/test_genui_registry.py` | `test/api/orchestration` | `planned_not_written` |
| `test_agents/test_orchestrator_runtime_policy.py` | `test/api/orchestration` | `planned_not_written` |
| `test_agents/test_phase_handlers.py` | `test/api/orchestration` | `planned_not_written` |
| `test_agents/test_pre_strategy_dynamic_rules.py` | `test/api/orchestration` | `planned_not_written` |
| `test_agents/test_session_title_service.py` | `test/api/orchestration` | `planned_not_written` |
| `test_agents/test_static_instruction_cache.py` | `test/api/orchestration` | `planned_not_written` |
| `test_agents/test_stub_handler_stage_loading.py` | `test/api/orchestration` | `planned_not_written` |
| `test_api/test_auth_flow_from_script.py` | `test/api/auth` | `partially_covered` |
| `test_api/test_broker_accounts_credentials.py` | `test/api/broker_accounts` | `planned_not_written` |
| `test_api/test_broker_accounts_paper_only.py` | `test/api/broker_accounts` | `planned_not_written` |
| `test_api/test_change_password.py` | `test/api/auth` | `partially_covered` |
| `test_api/test_chat_debug_trace_header.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_chat_stream.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_chat_stream_transport_resilience.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_cors_mode.py` | `test/api/system` | `planned_not_written` |
| `test_api/test_deployment_signal_order_flow.py` | `test/api/deployments` | `planned_not_written` |
| `test_api/test_deployments_lifecycle.py` | `test/api/deployments` | `planned_not_written` |
| `test_api/test_health.py` | `test/api/system` | `planned_not_written` |
| `test_api/test_jwt.py` | `test/api/auth` | `partially_covered` |
| `test_api/test_kyc_e2e_verbose.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_kyc_flow.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_kyc_flow_from_script.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_login.py` | `test/api/auth` | `partially_covered` |
| `test_api/test_login_response.py` | `test/api/auth` | `partially_covered` |
| `test_api/test_manual_trade_actions.py` | `test/api/deployments` | `planned_not_written` |
| `test_api/test_market_data_endpoints.py` | `test/api/market_data` | `partially_covered` |
| `test_api/test_mcp_history_persistence.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_me.py` | `test/api/auth` | `partially_covered` |
| `test_api/test_notification_preferences.py` | `test/api/notification_preferences` | `planned_not_written` |
| `test_api/test_paper_trading_full_pipeline.py` | `test/api/deployments` | `planned_not_written` |
| `test_api/test_portfolio_endpoints.py` | `test/api/trading_runtime` | `planned_not_written` |
| `test_api/test_pre_strategy_robustness.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_pre_strategy_to_strategy_e2e_live.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_preferences.py` | `test/api/auth` | `partially_covered` |
| `test_api/test_rate_limit.py` | `test/api/system` | `planned_not_written` |
| `test_api/test_refresh.py` | `test/api/auth` | `partially_covered` |
| `test_api/test_register.py` | `test/api/auth` | `partially_covered` |
| `test_api/test_session_titles.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_sessions_archive.py` | `test/api/sessions` | `planned_not_written` |
| `test_api/test_social_connectors.py` | `test/api/social_connectors` | `planned_not_written` |
| `test_api/test_startup_shutdown.py` | `test/api/system` | `planned_not_written` |
| `test_api/test_status.py` | `test/api/trading_runtime` | `planned_not_written` |
| `test_api/test_status_live_trading_probe.py` | `test/api/trading_runtime` | `planned_not_written` |
| `test_api/test_strategies_list_versions.py` | `test/api/strategies` | `planned_not_written` |
| `test_api/test_strategy_confirm.py` | `test/api/strategies` | `planned_not_written` |
| `test_api/test_strategy_stream_live.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_stream_empty_output_fallback.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_stream_error_detail.py` | `test/api/chat` | `partially_covered` |
| `test_api/test_telegram_test_target_endpoint.py` | `test/api/social_connectors` | `planned_not_written` |
| `test_api/test_telegram_trade_approval_callback.py` | `test/api/trade_approvals` | `planned_not_written` |
| `test_api/test_trade_approvals_flow.py` | `test/api/trade_approvals` | `planned_not_written` |
| `test_api/test_trading_preferences.py` | `test/api/trading_preferences` | `planned_not_written` |
| `test_engine/test_alpaca_account_probe.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_alpaca_market_data_client_symbol_normalization.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_alpaca_order_sync.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_alpaca_quote_endpoint_fallback.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_alpaca_stream_reconnect.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_backtest_analytics.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_backtest_condition_vectorized.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_backtest_engine.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_backtest_service.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_bar_aggregator_boundaries.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_black_swan_scenarios.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_broker_adapter_contract.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_credentials_cipher.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_data_loader.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_factor_cache_dedup.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_feature_indicator_wrapper.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_feature_registry.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_live_dsl_signal_runtime.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_local_coverage_detector.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_market_data_redis_store.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_market_data_sync_service.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_monte_carlo_statistics.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_optimization_algorithms.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_optimization_pareto.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_order_idempotency.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_order_state_machine.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_param_mutation.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_param_sensitivity_scan.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_performance_quantstats.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_pnl_engine.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_position_reconcile.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_ring_buffer.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_risk_gate.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_strategy_dsl_pipeline.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_strategy_storage.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_stress_job_service.py` | `test/domain/engine` | `planned_not_written` |
| `test_engine/test_timeframe_scheduler.py` | `test/domain/engine` | `planned_not_written` |
| `test_infra/test_backtest_tasks.py` | `test/celery/worker` | `planned_not_written` |
| `test_infra/test_broker_retry_and_circuit_breaker.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_celery_limits.py` | `test/celery/worker` | `planned_not_written` |
| `test_infra/test_celery_paper_trading_queue.py` | `test/celery/worker` | `planned_not_written` |
| `test_infra/test_celery_trade_approval_queue.py` | `test/celery/worker` | `planned_not_written` |
| `test_infra/test_chat_debug_trace.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_config.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_db_connection.py` | `test/db/postgres` | `partially_covered` |
| `test_infra/test_deployment_runtime_lock.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_maintenance_tasks.py` | `test/celery/worker` | `planned_not_written` |
| `test_infra/test_market_data_refresh_dedupe.py` | `test/celery/worker` | `planned_not_written` |
| `test_infra/test_market_data_tasks_redis_dual_write.py` | `test/celery/worker` | `planned_not_written` |
| `test_infra/test_mcp_context_auth.py` | `test/mcp/auth` | `planned_not_written` |
| `test_infra/test_openai_cost_tracker.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_openai_stream_service_errors.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_redis_connection.py` | `test/db/redis` | `planned_not_written` |
| `test_infra/test_runtime_kill_switch.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_runtime_state_store.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_sentry_http_status_middleware.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_sentry_integration_bootstrap.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_sentry_setup.py` | `test/infra/runtime` | `planned_not_written` |
| `test_infra/test_signal_store_externalization.py` | `test/infra/runtime` | `planned_not_written` |
| `test_mcp/test_backtest_tools.py` | `test/mcp/router` | `partially_covered` |
| `test_mcp/test_dev_proxy.py` | `test/mcp/router` | `partially_covered` |
| `test_mcp/test_market_data_sync_tools.py` | `test/mcp/router` | `partially_covered` |
| `test_mcp/test_market_data_tools.py` | `test/mcp/router` | `partially_covered` |
| `test_mcp/test_market_data_tools_live.py` | `test/mcp/router` | `partially_covered` |
| `test_mcp/test_server_domains.py` | `test/mcp/router` | `partially_covered` |
| `test_mcp/test_strategy_tools.py` | `test/mcp/router` | `partially_covered` |
| `test_mcp/test_stress_tools.py` | `test/mcp/router` | `partially_covered` |
| `test_mcp/test_trading_tools.py` | `test/mcp/router` | `partially_covered` |
| `test_models/test_auth_service.py` | `test/db/models` | `planned_not_written` |
| `test_models/test_constraints.py` | `test/db/models` | `planned_not_written` |
| `test_models/test_jsonb_fields.py` | `test/db/models` | `planned_not_written` |
| `test_models/test_models.py` | `test/db/models` | `planned_not_written` |
| `test_models/test_relationships.py` | `test/db/models` | `planned_not_written` |
| `test_models/test_seed_data_from_script.py` | `test/db/models` | `planned_not_written` |
| `test_models/test_trade_approval_request_model.py` | `test/db/models` | `planned_not_written` |
| `test_models/test_trading_models.py` | `test/db/models` | `planned_not_written` |
| `test_models/test_user_settings.py` | `test/db/models` | `planned_not_written` |
| `test_services/test_notification_outbox_service.py` | `test/services/notification` | `planned_not_written` |
