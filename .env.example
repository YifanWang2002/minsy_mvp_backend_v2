# Minsy backend environment template
# Copy this file to .env and fill secrets/addresses for your machine.

# -----------------------------------------------------------------------------
# Runtime mode (single switch for dev/prod behavior)
# -----------------------------------------------------------------------------
# APP_ENV controls:
# 1) MCP target selection (MCP_SERVER_URL_DEV vs MCP_SERVER_URL_PROD)
# 2) CORS strategy (dev/test: allow all origins; prod: use CORS_ORIGINS)
APP_ENV=dev

# -----------------------------------------------------------------------------
# App and server
# -----------------------------------------------------------------------------
APP_NAME=Minsy
DEBUG=true
API_V1_PREFIX=/api/v1
HOST=0.0.0.0
PORT=8000
LOG_LEVEL=INFO
CHAT_DEBUG_TRACE_ENABLED=false
CHAT_DEBUG_TRACE_MODE=compact

# -----------------------------------------------------------------------------
# OpenAI + MCP
# -----------------------------------------------------------------------------
OPENAI_API_KEY=<your_openai_api_key>
OPENAI_RESPONSE_MODEL=gpt-5.2
MCP_SERVER_URL_DEV=https://dev.minsyai.com/mcp
MCP_SERVER_URL_PROD=https://mcp.minsyai.com/mcp
MCP_CONTEXT_SECRET=
MCP_CONTEXT_TTL_SECONDS=300

# -----------------------------------------------------------------------------
# PostgreSQL
# -----------------------------------------------------------------------------
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=123456
POSTGRES_DB=minsy_pgsql
POSTGRES_POOL_SIZE=10
POSTGRES_MAX_OVERFLOW=20
SQLALCHEMY_ECHO=false

# -----------------------------------------------------------------------------
# Redis + Celery
# -----------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_MAX_CONNECTIONS=50
CELERY_BROKER_URL=
CELERY_RESULT_BACKEND=
CELERY_TASK_DEFAULT_QUEUE=backtest
CELERY_TASK_TIME_LIMIT_SECONDS=1800
CELERY_TASK_SOFT_TIME_LIMIT_SECONDS=1740
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_TASK_ACKS_LATE=true
CELERY_TASK_ALWAYS_EAGER=false
CELERY_TIMEZONE=UTC

# -----------------------------------------------------------------------------
# Maintenance jobs
# -----------------------------------------------------------------------------
POSTGRES_BACKUP_ENABLED=true
POSTGRES_BACKUP_DIR=backups/postgres
POSTGRES_BACKUP_RETENTION_COUNT=14
POSTGRES_BACKUP_HOUR_UTC=3
POSTGRES_BACKUP_MINUTE_UTC=0
POSTGRES_PG_DUMP_BIN=pg_dump
USER_EMAIL_CSV_EXPORT_ENABLED=true
USER_EMAIL_CSV_PATH=exports/user_emails.csv
USER_EMAIL_CSV_EXPORT_INTERVAL_MINUTES=60

# -----------------------------------------------------------------------------
# CORS (used only when APP_ENV=prod)
# -----------------------------------------------------------------------------
CORS_ORIGINS=["https://app.minsyai.com","https://dev.minsyai.com"]
# Optional regex (also applied in prod) for dynamic localhost ports.
CORS_ORIGIN_REGEX=^http://(localhost|127\.0\.0\.1)(:\d+)?$

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
SECRET_KEY=<jwt_secret>
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440
REFRESH_TOKEN_EXPIRE_DAYS=7
AUTH_RATE_LIMIT=30
AUTH_RATE_WINDOW=60
